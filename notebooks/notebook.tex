
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Basis Function of CDE with low Pe}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k}{using} \PY{n}{PyPlot}
        \PY{k}{using} \PY{n}{Base}\PY{o}{.}\PY{n}{Test}
        
        \PY{c}{\PYZsh{}\PYZsh{} Utilities}
        \PY{n}{δ}\PY{p}{(}\PY{n}{𝐱}\PY{p}{)} \PY{o}{=} \PY{n}{prod}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{x} \PY{n}{≈} \PY{l+m+mf}{0.} \PY{o}{?} \PY{l+m+mf}{1.} \PY{o}{:} \PY{l+m+mf}{0.}\PY{p}{,} \PY{n}{𝐱}\PY{p}{)}\PY{p}{)} \PY{c}{\PYZsh{} Dirac delta}
        \PY{n}{δ₌} \PY{o}{=} \PY{n}{Σ} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x}\PY{o}{\PYZsq{}}\PY{o}{/} \PY{n}{Σ} \PY{o}{*} \PY{n}{x}\PY{p}{)}\PY{p}{)} \PY{c}{\PYZsh{} approximate Dirac delta}
        \PY{p}{;}
\end{Verbatim}


    \section{Sequential Latent Force Modelling of the Convection-Diffusion
Equation for Source
Identification}\label{sequential-latent-force-modelling-of-the-convection-diffusion-equation-for-source-identification}

    \subsection{Fluid Flow in Porous
Media}\label{fluid-flow-in-porous-media}

... Darcy's law, etc.

\subsection{Hydrodynamic Solute
Modelling}\label{hydrodynamic-solute-modelling}

\subsubsection{Diffusion Equation}\label{diffusion-equation}

The concentration of solute particles in a system can be described in
terms of their diffusion over time, with some dispersivity parameter
related to the physical properties of the porous medium(/media) in the
system; the chemical make-up of the solute; and other factors such as
density, temperature, solvent properties. \(\mathcal{D}(\mathbf{x})\) is
a diffusion tensor, but may be represented as a scalar where it is
constant and isotropic: \(\mathcal{D} = \mathrm{diag}\{D, D, \ldots\}\)

\[
    \frac{\partial}{\partial t}\mathcal{C}(\mathbf{x},t) = \nabla\cdot\left(\mathcal{D}(\mathbf{x})\nabla \mathcal{C}(\mathbf{x},t)\right)
\]

The diffusion equation is a generalised form of the heat equation. As
such, the resulting solution for a homogeneous media is typically
Gaussian in nature. An example of this can be seen in the analytic
solution of the 1-D diffusion equation with constant diffusion and an
instantaneous point injection
\(\mathcal{C}(x, 0) = m_0\delta(x - u_0)\), where \(\delta\) is the
Dirac delta function and \(u_0\) is the source location, and \(m_0\) is
the mass of the injection:

\[
    \mathcal{C}(x,t) = \frac{m_0}{\sqrt{4\pi Dt}}\exp\left(-\frac{(x-u_0)^2}{4Dt}\right)
\]

The transport system defined here can be considered Fickian, in that it
follows Fick's laws, and thus the dispersion of particles in the system
can be assumed to be approximately proportionally Gaussian. In
non-constant dispersivity, notably in heterogeneous media, there may be
some convolution of the shape of the Gaussian.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{m₀}\PY{p}{,} \PY{n}{u₀}\PY{p}{,} \PY{n}{D} \PY{o}{=} \PY{l+m+mf}{1.}\PY{p}{,} \PY{l+m+mf}{0.}\PY{p}{,} \PY{l+m+mf}{0.1} \PY{c}{\PYZsh{} initial mass, source location and dispersivity coefficient}
        
        \PY{n}{𝐱} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{2.5}\PY{o}{:}\PY{l+m+mf}{0.005}\PY{o}{:}\PY{l+m+mf}{2.5}       \PY{c}{\PYZsh{} discrete sampling mesh of locations 𝐱}
        \PY{n}{𝐭} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{6}                 \PY{c}{\PYZsh{} discrete sampling times t = 1...6}
        
        \PY{c}{\PYZsh{} Analytic solution to diffusion equation}
        \PY{n}{Cᴰ}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{t}\PY{p}{)} \PY{o}{=} \PY{p}{(}\PY{n}{m₀}\PY{o}{/}\PY{o}{√}\PY{p}{(}\PY{l+m+mi}{4}\PY{n+nb}{π}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{exp}\PY{o}{.}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{u₀}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{l+m+mi}{2}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{4}\PY{n}{D}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} 
        
        \PY{c}{\PYZsh{} Initial condition}
        \PY{n}{C₀} \PY{o}{=} \PY{n}{m₀}\PY{o}{.*}\PY{n}{map}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{δ}\PY{p}{(}\PY{n}{x}\PY{o}{\PYZhy{}}\PY{n}{u₀}\PY{p}{)}\PY{p}{,} \PY{n}{𝐱}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{C₀}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        
        \PY{c}{\PYZsh{} Sample and plot solution at time t}
        \PY{k}{for} \PY{n}{t} \PY{o}{∈} \PY{n}{𝐭}
            \PY{n}{plot}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{Cᴰ}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{t}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{k}{end}
        
        \PY{c}{\PYZsh{} Plot anotation}
        \PY{n}{xlabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}x}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{ylabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{c}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZob{}}\PY{l+s}{C}\PY{l+s}{\PYZcb{}}\PY{l+s}{(}\PY{l+s}{x}\PY{l+s}{,}\PY{l+s}{t}\PY{l+s}{)}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{n}{map}\PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{string}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}t}\PY{l+s}{=}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n+nd}{@sprintf}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}2.1f}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{t}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0} \PY{p}{;} \PY{n}{collect}\PY{p}{(}\PY{n}{𝐭}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{A}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{y}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{c}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{o}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{f}\PY{l+s}{f}\PY{l+s}{u}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{e}\PY{l+s}{q}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{1}\PY{l+s}{\PYZhy{}}\PY{l+s}{D}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{o}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_3_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Convection-Diffusion
Equation}\label{convection-diffusion-equation}

While the diffusion equation describes how a substance will spread, in
systems under the influence of flow fields there can be some velocity
component describing some convection of the solute particles. This can
be interpreted as a shift of the concentration at a rate proximately
equal to the velocity \(\mathbf{v}(\mathbf{x})\) of the underlying flow
field.

\[
    \frac{\partial}{\partial t}\mathcal{C}(\mathbf{x},t) = \nabla\cdot\left(\mathcal{D}(\mathbf{x})\nabla \mathcal{C}(\mathbf{x},t)\right) + \nabla\cdot\left(\mathbf{v}(\mathbf{x})\mathcal{C}(\mathbf{x}, t)\right)
\]

The first term on the right-hand side of the equation is the diffusion
term, and the second term describes the convection. Where
\(\mathbf{v} = \mathbf{0}\), this is trivially the diffusion equation,
and where \(\mathcal{D} = \mathbf{0}\), it is the continuity equation.

With injection of solute into the system, the convection-diffusion
equation can be adapted with an input term \(u(\mathbf{x}, t)\):

\[
    \frac{\partial}{\partial t}\mathcal{C}(\mathbf{x},t) = \nabla\cdot\left(\mathcal{D}(\mathbf{x})\nabla \mathcal{C}(\mathbf{x},t)\right) + \nabla\cdot\left(\mathbf{v}(\mathbf{x})\mathcal{C}(\mathbf{x}, t)\right) + u(\mathbf{x}, t)
\]

Note that in system where the velocity field is predominantly a
horizontal flow field, and the solute is subject to mechanical
dispersion (to a significantly greater degree than ionic diffusion), the
model may be termed the \emph{advection-dispersion model}.

    As an analogue to the example above, the analytic solution to the 1-D
convection-diffusion equation with instantaneous point injection is
given by

\[
    \mathcal{C}(x,t) = \frac{m_0}{\sqrt{4\pi Dt}}\exp\left(-\frac{(x-u_0 - v)^2}{D}\right)
\]

Where \(D\) and \(v\) are constant, and the initial condition is given
by \(\mathcal{C}(x, 0) = m_0\delta(x - u_0)\).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{m₀}\PY{p}{,} \PY{n}{u₀}\PY{p}{,} \PY{n}{D}\PY{p}{,} \PY{n}{v} \PY{o}{=} \PY{l+m+mf}{1.}\PY{p}{,} \PY{l+m+mf}{0.}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.25} \PY{c}{\PYZsh{} initial mass, source location, dispersivity coefficient and velocity}
        
        \PY{n}{𝐱} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{o}{:}\PY{l+m+mf}{0.005}\PY{o}{:}\PY{l+m+mf}{2.5}       \PY{c}{\PYZsh{} discrete sampling mesh of locations 𝐱}
        \PY{n}{𝐭} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{6}                 \PY{c}{\PYZsh{} discrete sampling times t = 1...6}
        
        \PY{c}{\PYZsh{} Analytic solution to advection\PYZhy{}dispersion with point injection}
        \PY{n}{Cᴬ}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{t}\PY{p}{)} \PY{o}{=} \PY{p}{(}\PY{n}{m₀}\PY{o}{/}\PY{o}{√}\PY{p}{(}\PY{l+m+mi}{4}\PY{n+nb}{π}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{exp}\PY{o}{.}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{u₀} \PY{o}{\PYZhy{}} \PY{n}{v}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{l+m+mi}{2}\PY{o}{/}\PY{n}{D}\PY{p}{)}
        
        \PY{c}{\PYZsh{} Initial condition}
        \PY{n}{C₀} \PY{o}{=} \PY{n}{m₀}\PY{o}{.*}\PY{n}{map}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{δ}\PY{p}{(}\PY{n}{x}\PY{o}{\PYZhy{}}\PY{n}{u₀}\PY{p}{)}\PY{p}{,} \PY{n}{𝐱}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{C₀}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        
        \PY{c}{\PYZsh{} Sample and plot solution at time t}
        \PY{k}{for} \PY{n}{t} \PY{o}{∈} \PY{n}{𝐭}
            \PY{n}{plot}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{Cᴬ}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{t}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{k}{end}
        
        \PY{c}{\PYZsh{} Plot anotation}
        \PY{n}{xlabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}x}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{ylabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{c}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZob{}}\PY{l+s}{C}\PY{l+s}{\PYZcb{}}\PY{l+s}{(}\PY{l+s}{x}\PY{l+s}{,}\PY{l+s}{t}\PY{l+s}{)}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{n}{map}\PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{string}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}t}\PY{l+s}{=}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n+nd}{@sprintf}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}2.1f}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{t}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0} \PY{p}{;} \PY{n}{collect}\PY{p}{(}\PY{n}{𝐭}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{A}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{y}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{c}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{o}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZhy{}}\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{f}\PY{l+s}{f}\PY{l+s}{u}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{e}\PY{l+s}{q}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{1}\PY{l+s}{\PYZhy{}}\PY{l+s}{D}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{o}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{p}\PY{l+s}{o}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_6_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Sequential Latent Force
Modelling}\label{sequential-latent-force-modelling}

\subsubsection{Latent Force Model}\label{latent-force-model}

Consider the convection-diffusion equation with some spatio-temporal
input function \(u(\mathbf{x},t)\) describing, for example injection (or
alternatively suction). A latent force interpretation would describe
this as a stochastic differential equation, with the input \(u\)
modelled as a Gaussian process.

\[
    \frac{\partial}{\partial t}\mathcal{C}(\mathbf{x},t) = \nabla\cdot\left(\mathcal{D}(\mathbf{x})\nabla \mathcal{C}(\mathbf{x},t)\right) + \nabla\cdot\left(\mathbf{v}(\mathbf{x})\mathcal{C}(\mathbf{x}, t)\right) + u(\mathbf{x}, t)
\]

\[
    u(\mathbf{x},t) \sim \mathcal{GP}\left(m_u(\mathbf{x}, t), \kappa_u(\mathbf{x},\mathbf{x}';t,t')\right)
\]

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c}{\PYZsh{} ...}
\end{Verbatim}


    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

    \subsubsection{Evolutionary Model}\label{evolutionary-model}

Assuming a constant (scalar) dispersivity, and constant velocity field,
where now the concentration is denoted \(f \triangleq C(\mathbf{x}, t)\)

\[
    \frac{\partial}{\partial t}f(\mathbf{x},t) = \left[D\nabla\cdot\left(\nabla + \frac{\mathbf{v}}{D}\mathcal{I}\right)\right]f(\mathbf{x},t) + \mathbf{C}_u\mathbf{u}(\mathbf{x},t)
\]

\[
    \frac{\partial}{\partial t}\mathbf{u}(\mathbf{x},t) + \mathscr{A}_u\mathbf{u}(\mathbf{x},t) + \mathbf{B}_uw(\mathbf{x},t)
\]

Where \(w(\mathbf{x},t)\) is a white noise process and \(\mathbf{u}\)
represents the reparameterisation of GP \(u(\mathbf{x},t)\) based on the
covariance function used to model it.

The differential operator of the evolutionary process in
\(f(\mathbf{x},t)\) is here defined
\(\mathscr{A}_f = D\nabla\cdot\left(\nabla + (\mathbf{v}/D)\mathcal{I}\right)\),
where \(\nabla\) is the gradient operator and \(\mathcal{I}\) is the
identity operator.

    \subsubsection{Hilbert Space
Approximation}\label{hilbert-space-approximation}

To approximate the above equation, a numerical approach is required.
Using Galerkin's method of approximating the solution in a finite space
representated by a set of basis functions, such that a function
\(g(\mathbf{x},t)\) subject to a PDE can be represented as the sum of
basis functions with true representation in the limit of the number of
basis functions

\[
    g(\mathbf{x},t) = \sum^\infty_{i=1} g_i(t)\phi_i(\mathbf{x})
\]

Consider the eigenfunction representation of a linear operator
\(\mathscr{D}\): \(\mathscr{D}\phi_i = \lambda_i\phi_i\), where
\(\phi_i\) is an \emph{eigenfunction} of \(\mathscr{D}\) on some defined
function space and \(\lambda_i\) is its corresponding scalar
\emph{eigenvalue}.

Representing the evolutionary operator \(\mathscr{A}_f\) in this manner
leads to a steady-state PDE over an eigenfunction

\[
    \mathscr{A}_f\phi_i = \lambda_i\phi_i
\]

\[
\Rightarrow \left[D\nabla\cdot\left(\nabla + (\mathbf{v}/D)\mathcal{I}\right)\right]\phi_i - \lambda_i\phi_i = 0
\] \[
\Rightarrow D\nabla^2\phi_i + \nabla\cdot\left(\mathbf{v}\phi_i\right) - \lambda_i\phi_i = 0
\]

    \subsection{Model}\label{model}

Consider a 2-D convection-diffusion equation with a constant flow field
and scalar isotropic dispersivity, and unknown injection that can be
sampled from a spatio-temporal Gaussian process with unknown mean and
variance.

\[
    \frac{\partial}{\partial t}f(\mathbf{x},t) = D\nabla^2f(\mathbf{x},t) + \nabla\cdot\left(\mathbf{v}\mathcal{f}(\mathbf{x}, t)\right) + u(\mathbf{x}, t)
\]

Let the solution be defined on a 2-D space
\(\Omega = [-L_x, L_x] \times [-L_y, L_y]\), with Dirichlet boundary
conditions
\(f(\mathbf{x}, t) = 0\ \forall\ \mathbf{x} \in \partial\Omega\).

Using the eigenfunction basis representation of the differential
operator describing the evolution of \(f\), the steady-state PDE
describing the form of bases \(\phi_i(\mathbf{x})\) can be defined:

\[
    \frac{\partial^2\phi_i}{\partial x^2} + \frac{\partial^2\phi_i}{\partial y^2} + \frac{v_x}{D}\frac{\partial \phi_i}{\partial x} + \frac{v_y}{D}\frac{\partial \phi_i}{\partial y} - \frac{\lambda_i}{D}\phi_i(\mathbf{x}) = 0
\]

Substituting
\(\phi_i(\mathbf{x}) = \exp\left(-(\mathbf{v}\cdot\mathbf{x})/2D\right)\varphi_i(\mathbf{x})\)
gives the equation in the form of the homogeneous Helmholtz equation:

\[
    \frac{\partial^2\varphi_i}{\partial x^2} + \frac{\partial^2\varphi_i}{\partial y^2} -\lambda'_i\varphi_i(\mathbf{x}) = 0
\]

Where now the modified eigenfunctions \(\varphi_i\) are equivalent to
those of the Laplace operator in 2-D, and the modified eigenvalues are
defined
\(\lambda'_i = \frac{\lambda_i}{D} + \frac{1}{4D^2}\|\mathbf{v}\|^2\).
For the Dirichlet boundary conditions described, the eigenvectors of the
evolutionary convection-diffusion model non-unique, and can be described
in the form, where \(\Omega = [0,1]\times[0,1]\):

...

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c}{\PYZsh{}\PYZsh{} Prototypes}
        \PY{c}{\PYZsh{} proto\PYZus{}λ = L \PYZhy{}\PYZgt{} (n \PYZhy{}\PYZgt{} sum(π*n./(2L)))}
        \PY{c}{\PYZsh{} proto\PYZus{}ϕ = L \PYZhy{}\PYZgt{} (n \PYZhy{}\PYZgt{} (x \PYZhy{}\PYZgt{} prod(sqrt.(1./L).*sin.(π*n.*(x + L)./(2L)))))}
        
        \PY{n}{proto\PYZus{}λ} \PY{o}{=} \PY{p}{(}\PY{n}{L}\PY{p}{,} \PY{n}{D}\PY{p}{,} \PY{n}{v}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{n} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{sum}\PY{p}{(}\PY{n+nb}{π}\PY{o}{*}\PY{n}{n}\PY{o}{./}\PY{p}{(}\PY{l+m+mi}{2}\PY{n}{L}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{v⋅v}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{4}\PY{n}{D}\PY{p}{)}
        \PY{n}{proto\PYZus{}ϕ} \PY{o}{=} \PY{p}{(}\PY{n}{L}\PY{p}{,} \PY{n}{D}\PY{p}{,} \PY{n}{v}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{n} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{prod}\PY{p}{(}\PY{n}{sqrt}\PY{o}{.}\PY{p}{(}\PY{l+m+mf}{1.}\PY{o}{/}\PY{n}{L}\PY{p}{)}\PY{o}{.*}\PY{n}{sin}\PY{o}{.}\PY{p}{(}\PY{n+nb}{π}\PY{o}{*}\PY{n}{n}\PY{o}{.*}\PY{p}{(}\PY{n}{x}\PY{o}{+}\PY{n}{L}\PY{p}{)}\PY{o}{./}\PY{p}{(}\PY{l+m+mi}{2}\PY{n}{L}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.*}\PY{n}{exp}\PY{o}{.}\PY{p}{(}\PY{p}{(}\PY{n}{v⋅x}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{n}{D}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} (::\#23) (generic function with 1 method)
\end{Verbatim}
            
    \subsubsection{Parameter setup}\label{parameter-setup}

\begin{itemize}
\tightlist
\item
  \(\Omega = [-2, 2] \times [-0.5, 0.5]\)
\item
  \(\mathbf{v} = [-1.5, -0.2]^\text{T}\)
\item
  \(D = 0.1\)
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{L}\PY{p}{,} \PY{n}{D}\PY{p}{,} \PY{n}{𝐯} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{1.}\PY{p}{;} \PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{;}\PY{l+m+mf}{0.}\PY{p}{]} \PY{c}{\PYZsh{} Advection\PYZhy{}dispersion}
        \PY{c}{\PYZsh{}L, D, 𝐯 = [1.; 1.], 1e\PYZhy{}3, [0.;0.] \PYZsh{} Heat equation}
        
        \PY{c}{\PYZsh{}λ, ϕ = proto\PYZus{}λ(L), proto\PYZus{}ϕ(L)}
        \PY{n}{ϕ}\PY{p}{,} \PY{n}{λ} \PY{o}{=} \PY{n}{proto\PYZus{}ϕ}\PY{p}{(}\PY{n}{L}\PY{p}{,} \PY{n}{D}\PY{p}{,}\PY{n}{𝐯}\PY{p}{)}\PY{p}{,} \PY{n}{proto\PYZus{}λ}\PY{p}{(}\PY{n}{L}\PY{p}{,} \PY{n}{D}\PY{p}{,} \PY{n}{𝐯}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \subsubsection{\texorpdfstring{Plot flow field in
\(\Omega\)}{Plot flow field in \textbackslash{}Omega}}\label{plot-flow-field-in-omega}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{nₓ} \PY{o}{=} \PY{l+m+mi}{20}
        \PY{n}{𝑥}\PY{p}{,}\PY{n}{𝑦} \PY{o}{=} \PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{L}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{L}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}
        
        \PY{n}{quiver}\PY{p}{(}\PY{n}{𝑥}\PY{p}{,} \PY{n}{𝑦}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{\PYZus{}} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{𝐯}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{nₓ}\PY{o}{*}\PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{nₓ}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{\PYZus{}} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{𝐯}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{nₓ}\PY{o}{*}\PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{nₓ}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{function} \PY{n}{set\PYZus{}layout}\PY{p}{(}\PY{p}{)}
            \PY{n}{axis}\PY{p}{(}\PY{o}{:}\PY{n}{square}\PY{p}{)}
            \PY{n}{xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{L}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{l+m+mf}{0.1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{L}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{+}\PY{l+m+mf}{0.1}\PY{p}{)}
            \PY{n}{xlabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}x}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{ylabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}y}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{k}{end}
        
        \PY{n}{set\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{title}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s}{V}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{c}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{y}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{i}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{b}\PY{l+s}{f}\PY{l+s}{\PYZob{}}\PY{l+s}{v}\PY{l+s}{\PYZcb{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Discretise system}\label{discretise-system}

Resolution: \(n_x = 200 \times 200\)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{nₓ} \PY{o}{=} \PY{l+m+mi}{200}
        
        \PY{n}{𝑥}\PY{p}{,}\PY{n}{𝑦} \PY{o}{=} \PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{L}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{L}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}
        
        \PY{n}{𝐱} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{xᵢ}\PY{p}{;}\PY{n}{xⱼ}\PY{p}{]} \PY{k}{for} \PY{n}{xᵢ} \PY{o}{∈} \PY{n}{𝑥} \PY{k}{for} \PY{n}{xⱼ} \PY{o}{∈} \PY{n}{𝑦}\PY{p}{]}\PY{p}{;}
\end{Verbatim}


    \subsection{\texorpdfstring{Map \(\Omega\) to basis function
representation}{Map \textbackslash{}Omega to basis function representation}}\label{map-omega-to-basis-function-representation}

\begin{itemize}
\tightlist
\item
  \(N=100\) basis functions
\item
  \(f_n, \lambda_n\) define N eigenfunctions and corresponding
  eigenvectors
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c}{\PYZsh{}\PYZsh{} Create basis functions}
        \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{100} \PY{c}{\PYZsh{} maximum number of basis functions}
        
        \PY{c}{\PYZsh{}\PYZsh{} Generate aribtrary number of eigenvalues (e.g. 10x10)}
        \PY{n}{𝐧} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{nᵢ}\PY{p}{;} \PY{n}{nⱼ}\PY{p}{]} \PY{k}{for} \PY{n}{nᵢ} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{50} \PY{k}{for} \PY{n}{nⱼ} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{50}\PY{p}{]}
        \PY{n}{λₙ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{λ}\PY{p}{,} \PY{n}{𝐧}\PY{p}{)}
                    
        \PY{c}{\PYZsh{}\PYZsh{} Sort in descending order and get N most principal eigenvalues }
        \PY{n}{ix} \PY{o}{=} \PY{n}{sortperm}\PY{p}{(}\PY{n}{λₙ}\PY{p}{)}
        \PY{n}{𝐧}  \PY{o}{=} \PY{n}{𝐧}\PY{p}{[}\PY{n}{ix}\PY{p}{[}\PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N}\PY{p}{]}\PY{p}{]}
        
        \PY{c}{\PYZsh{}\PYZsh{} Generate N eigenvalues and corresponding eigenfunctions evaluated on 𝐱 ∈ Ω}
        \PY{n}{λₙ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{λ}\PY{p}{,} \PY{n}{𝐧}\PY{p}{)}
        \PY{n}{fₙ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{n} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{map}\PY{p}{(}\PY{n}{ϕ}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{,} \PY{n}{𝐱}\PY{p}{)}\PY{p}{,} \PY{n}{𝐧}\PY{p}{)}
                    
        \PY{n}{println}\PY{p}{(}\PY{n+nd}{@sprintf}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{E}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{λ}\PY{l+s}{ₙ}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ }\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{typeof}\PY{p}{(}\PY{n}{λₙ}\PY{p}{)}\PY{p}{,} \PY{n}{string}\PY{p}{(}\PY{n}{size}\PY{p}{(}\PY{n}{λₙ}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{println}\PY{p}{(}\PY{n+nd}{@sprintf}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{E}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{e}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{f}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{ₙ}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ }\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{d}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{typeof}\PY{p}{(}\PY{n}{fₙ}\PY{p}{)}\PY{p}{,} \PY{n}{string}\PY{p}{(}\PY{n}{size}\PY{p}{(}\PY{n}{fₙ}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{string}\PY{p}{(}\PY{n}{size}\PY{p}{(}\PY{n}{fₙ}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Eigenvalues λₙ is an Array\{Float64,1\} with dimension (100,)
Evaluated eigenfunctions fₙ is an Array\{Array\{Float64,1\},1\} with dimension (100,) and internal dimensions (40000,)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c}{\PYZsh{}\PYZsh{} Plot example basis functions}
         
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{for} \PY{p}{(}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{)} \PY{o}{∈} \PY{n}{enumerate}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{round}\PY{p}{(}\PY{k+kt}{Int}\PY{p}{,} \PY{n}{N}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{N}\PY{p}{]}\PY{p}{)}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{310} \PY{o}{+} \PY{n}{j}\PY{p}{)}
             \PY{n}{contour}\PY{p}{(}\PY{n}{𝑥}\PY{p}{,} \PY{n}{𝑦}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{nₓ}\PY{p}{,}\PY{n}{nₓ}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{set\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             
             \PY{n}{title}\PY{p}{(}\PY{n}{string}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{p}\PY{l+s}{h}\PY{l+s}{i}\PY{l+s}{\PYZus{}}\PY{l+s}{i}\PY{l+s}{(}\PY{l+s}{\PYZbs{}}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{b}\PY{l+s}{f}\PY{l+s}{\PYZob{}}\PY{l+s}{x}\PY{l+s}{\PYZcb{}}\PY{l+s}{)}\PY{l+s}{\PYZdl{}}\PY{l+s}{,}\PY{l+s}{ }\PY{l+s+si}{\PYZdl{}i}\PY{l+s}{=}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{i}\PY{p}{)}\PY{p}{)}\PY{p}{;}
             \PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Inner product space defined by basis
functions}\label{inner-product-space-defined-by-basis-functions}

\[
    \left\langle f, g\right\rangle_\phi = \int_{\Omega}\phi_f(\mathbf{x})\phi_g(\mathbf{x})\exp\left(\frac{\mathbf{v}\cdot\mathbf{x}}{D}\right)\partial\Omega
\]

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c}{\PYZsh{}\PYZsh{} Check orthogonality}
         
         \PY{c}{\PYZsh{} Inner product definition}
         \PY{n}{𝑱ᵩ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{𝑥} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{𝐯⋅𝑥}\PY{p}{)}\PY{o}{/}\PY{n}{D}\PY{p}{)}\PY{p}{,} \PY{n}{𝐱}\PY{p}{)}
         \PY{c}{\PYZsh{}𝑱ᵩ = 1.}
         \PY{n}{⋆}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)} \PY{o}{=} \PY{p}{(}\PY{n}{𝑥}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{𝑥}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{𝑦}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{𝑦}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{n}{sum}\PY{p}{(}\PY{n}{x}\PY{o}{.*}\PY{n}{y}\PY{o}{.*}\PY{n}{𝑱ᵩ}\PY{p}{)}
         
         \PY{n+nd}{@testset} \PY{l+s}{\PYZdq{}}\PY{l+s}{O}\PY{l+s}{r}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{o}\PY{l+s}{g}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{y}\PY{l+s}{\PYZdq{}} \PY{k}{begin}
             \PY{n+nd}{@testset} \PY{l+s}{\PYZdq{}}\PY{l+s}{D}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{g}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{s}\PY{l+s}{\PYZdq{}} \PY{k}{for} \PY{n}{i} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N}
                 \PY{n+nd}{@test} \PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{n}{⋆} \PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{n}{≈} \PY{l+m+mf}{1.} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}14}
             \PY{k}{end}
             \PY{n+nd}{@testset} \PY{l+s}{\PYZdq{}}\PY{l+s}{U}\PY{l+s}{p}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{s}\PY{l+s}{\PYZdq{}} \PY{k}{for} \PY{n}{i} \PY{o}{∈} \PY{p}{[}\PY{p}{[}\PY{n}{i\PYZus{}}\PY{p}{,}\PY{n}{j\PYZus{}}\PY{p}{]} \PY{k}{for} \PY{n}{i\PYZus{}} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N} \PY{k}{for} \PY{n}{j\PYZus{}} \PY{o}{∈} \PY{n}{i\PYZus{}}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N}\PY{p}{]}
                 \PY{n+nd}{@test} \PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{n}{⋆} \PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]} \PY{n}{≈} \PY{l+m+mf}{0.} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}14}
             \PY{k}{end}
             \PY{n+nd}{@testset} \PY{l+s}{\PYZdq{}}\PY{l+s}{U}\PY{l+s}{p}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{s}\PY{l+s}{\PYZdq{}} \PY{k}{for} \PY{n}{i} \PY{o}{∈} \PY{p}{[}\PY{p}{[}\PY{n}{i\PYZus{}}\PY{p}{,}\PY{n}{j\PYZus{}}\PY{p}{]} \PY{k}{for} \PY{n}{i\PYZus{}} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N} \PY{k}{for} \PY{n}{j\PYZus{}} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{i\PYZus{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
                 \PY{n+nd}{@test} \PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{n}{⋆} \PY{n}{fₙ}\PY{p}{[}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]} \PY{n}{≈} \PY{l+m+mf}{0.} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}14}
             \PY{k}{end}
         \PY{k}{end}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\textcolor{ansi-white-intense}{\textbf{Test Summary: | }}\textcolor{ansi-green-intense}{\textbf{ Pass  }}\textcolor{ansi-cyan-intense}{\textbf{Total}}
Orthogonality | \textcolor{ansi-green}{10000  }\textcolor{ansi-cyan}{10000}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{fₙ}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{n}{⋆} \PY{n}{fₙ}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{n}{≈} \PY{l+m+mf}{1.}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} true
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{σ₁}\PY{p}{,} \PY{n}{σ₂} \PY{o}{=} \PY{l+m+mf}{100.}\PY{p}{,} \PY{l+m+mf}{100.}
         \PY{n}{aₜ}\PY{p}{,} \PY{n}{bₜ} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.15}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{]}
         
         \PY{n}{𝑢}\PY{p}{(}\PY{n}{t}\PY{p}{)} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{exp}\PY{o}{.}\PY{p}{(}\PY{n}{σ₁}\PY{o}{*}\PY{p}{(}\PY{n}{aₜ} \PY{o}{\PYZhy{}} \PY{n}{t}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{.*} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{exp}\PY{o}{.}\PY{p}{(}\PY{n}{σ₂}\PY{o}{*}\PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}} \PY{n}{bₜ}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.\PYZca{}}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} 𝑢 (generic function with 1 method)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{nₜ} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{𝐭} \PY{o}{=} \PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{0.}\PY{p}{,} \PY{l+m+mf}{1.}\PY{p}{,} \PY{n}{nₜ}\PY{p}{)}
         
         \PY{n}{plot}\PY{p}{(}\PY{n}{𝐭}\PY{p}{,} \PY{n}{𝑢}\PY{p}{(}\PY{n}{𝐭}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s+si}{\PYZdl{}t}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{ylabel}\PY{p}{(}\PY{n}{L}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s}{i}\PY{l+s}{l}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{\PYZob{}}\PY{l+s}{u}\PY{l+s}{\PYZcb{}}\PY{l+s}{(}\PY{l+s}{t}\PY{l+s}{)}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{u₀} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.0} \PY{p}{;} \PY{l+m+mf}{0.0}\PY{p}{]}
         \PY{n}{m₀} \PY{o}{=} \PY{l+m+mf}{100.}
         \PY{n}{Σ}  \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
         
         \PY{n}{u}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{t}\PY{p}{)} \PY{o}{=} \PY{n}{m₀} \PY{o}{*} \PY{n}{map}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{δ₌}\PY{p}{(}\PY{n}{Σ}\PY{p}{)}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{u₀}\PY{p}{)}\PY{p}{,} \PY{n}{𝐱}\PY{p}{)} \PY{o}{.*} \PY{n}{𝑢}\PY{p}{(}\PY{n}{t}\PY{p}{)} \PY{o}{./} \PY{n}{sum}\PY{p}{(}\PY{n}{𝑢}\PY{p}{(}\PY{n}{𝐭}\PY{p}{)}\PY{p}{)}
         \PY{n}{𝐮ₜ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{u}\PY{p}{(}\PY{n}{𝐱}\PY{p}{,} \PY{n}{t}\PY{p}{)}\PY{p}{,} \PY{n}{𝐭}\PY{p}{)}
         
         \PY{n}{uₘₐₓ}\PY{p}{,} \PY{n}{uₘᵢₙ} \PY{o}{=} \PY{n}{maximum}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{maximum}\PY{p}{,} \PY{n}{𝐮ₜ}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{minimum}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{minimum}\PY{p}{,} \PY{n}{𝐮ₜ}\PY{p}{)}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \subsection{Map input to Hilbert space
representation}\label{map-input-to-hilbert-space-representation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c}{\PYZsh{} Map input to Hilbert space}
         \PY{n}{𝐮ᵩ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{uₜ} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{map}\PY{p}{(}\PY{n}{ϕᵢ} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{uₜ} \PY{n}{⋆} \PY{n}{ϕᵢ}\PY{p}{,} \PY{n}{fₙ}\PY{p}{)}\PY{p}{,} \PY{n}{𝐮ₜ}\PY{p}{)}
         
         \PY{c}{\PYZsh{} Remap Hilbert space representation to Cartesian space}
         \PY{n}{𝐮ₚ} \PY{o}{=} \PY{p}{[}\PY{n}{sum}\PY{p}{(}\PY{p}{[}\PY{n}{λᵢ} \PY{o}{*} \PY{n}{ϕᵢ} \PY{k}{for} \PY{p}{(}\PY{n}{λᵢ}\PY{p}{,} \PY{n}{ϕᵢ}\PY{p}{)} \PY{o}{∈} \PY{n}{zip}\PY{p}{(}\PY{n}{uᵩ}\PY{p}{,} \PY{n}{fₙ}\PY{p}{)}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{uᵩ} \PY{o}{∈} \PY{n}{𝐮ᵩ}\PY{p}{]}
         
         \PY{n}{vˣ}\PY{p}{,} \PY{n}{vʸ} \PY{o}{=} \PY{n}{𝐯}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{n}{ones}\PY{p}{(}\PY{n}{nₓ}\PY{o}{*}\PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{𝐯}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{n}{ones}\PY{p}{(}\PY{n}{nₓ}\PY{o}{*}\PY{n}{nₓ}\PY{p}{)}
         \PY{n}{𝑣ˣᵩ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{ϕᵢ} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{vˣ} \PY{n}{⋆} \PY{n}{ϕᵢ}\PY{p}{,} \PY{n}{fₙ}\PY{p}{)}
         \PY{n}{𝑣ʸᵩ} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{ϕᵢ} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{vʸ} \PY{n}{⋆} \PY{n}{ϕᵢ}\PY{p}{,} \PY{n}{fₙ}\PY{p}{)}
         
         \PY{n}{𝐯ₚ} \PY{o}{=} \PY{n}{sum}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{n}{λˣ} \PY{o}{*} \PY{n}{ϕᵢ}\PY{p}{,} \PY{n}{λʸ} \PY{o}{*} \PY{n}{ϕᵢ}\PY{p}{]} \PY{k}{for} \PY{p}{(}\PY{n}{λˣ}\PY{p}{,} \PY{n}{λʸ}\PY{p}{,} \PY{n}{ϕᵢ}\PY{p}{)} \PY{o}{∈} \PY{n}{zip}\PY{p}{(}\PY{n}{𝑣ˣᵩ}\PY{p}{,} \PY{n}{𝑣ʸᵩ}\PY{p}{,} \PY{n}{fₙ}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{p}{;}
\end{Verbatim}


    \subsection{Define an example input function and approximately solve the
system}\label{define-an-example-input-function-and-approximately-solve-the-system}

Here, the input function will be known, so the solution is
deterministic. The solution will be used to produce synthetic
measurements.

Consider the input function

\[
u(\mathbf{x},t) = m_0\delta^\approx_{\sigma_\delta}(\mathbf{x}-\mathbf{u}_0)\frac{\tilde{u}(t)}{\int \tilde{u}(t)\mathrm{d}t}
\]

Where \(\delta^\approx_{\sigma_\delta}(\mathbf{x})\) is the approximate
Dirac delta function as a multivariate Gaussian centered on
\(\mathbf{x}\) with covariance \(\sigma^2_\delta\), and where
\(\tilde{u}(t)\) is the injection curve:

\[
\tilde{u}(t) = \left(1 + \exp\left(\sigma_{\gamma_1}(a_t - t)\right)\right)^{-1}\left(1 + \exp\left(\sigma_{\gamma_2}(t - b_t)\right)\right)^{-1}
\]

Where \(a\) and \(b\) are injection start and stop times, respectively,
and \(\sigma_{\gamma_1}\) and \(\sigma_{\gamma_2}\) describe the inverse
delay response of the injection start and end respectively -- the higher
the value of \(\sigma_\gamma\), the sharper the change.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{c⁺}\PY{p}{,} \PY{n}{c⁻} \PY{o}{=} \PY{n}{uₘₐₓ}\PY{p}{,} \PY{n}{uₘᵢₙ}
         \PY{n}{logcontour} \PY{o}{=} \PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{z}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{contour}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{log}\PY{o}{.}\PY{p}{(}\PY{n}{z} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)}\PY{p}{,} \PY{n}{linspace}\PY{p}{(}\PY{n}{log}\PY{p}{(}\PY{n}{c⁻} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)}\PY{p}{,} \PY{n}{log}\PY{p}{(}\PY{n}{c⁺} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{function} \PY{n}{plot\PYZus{}u}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{z}\PY{p}{;} \PY{n}{\PYZus{}contour}\PY{o}{=}\PY{o}{:}\PY{k+kc}{true}\PY{p}{,} \PY{n}{c⁺} \PY{o}{=} \PY{n}{uₘₐₓ}\PY{p}{,} \PY{n}{c⁻} \PY{o}{=} \PY{n}{uₘᵢₙ}\PY{p}{,} \PY{n}{logarithm}\PY{o}{=}\PY{o}{:}\PY{k+kc}{true}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{logarithm} \PY{o}{==} \PY{o}{:}\PY{k+kc}{true}
                 \PY{n}{zₗ} \PY{o}{=} \PY{n}{log}\PY{o}{.}\PY{p}{(}\PY{n}{z} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)}
                 \PY{n}{c⁺}\PY{p}{,} \PY{n}{c⁻} \PY{o}{=} \PY{n}{log}\PY{p}{(}\PY{n}{c⁺} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)}\PY{p}{,} \PY{n}{log}\PY{p}{(}\PY{n}{c⁻} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)}
             \PY{k}{else}
                 \PY{n}{zₗ} \PY{o}{=} \PY{n}{z}
             \PY{k}{end}
             
             \PY{k}{if} \PY{n}{\PYZus{}contour} \PY{o}{==} \PY{o}{:}\PY{k+kc}{true}
                 \PY{n}{contour}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{zₗ}\PY{p}{,} \PY{n}{linspace}\PY{p}{(}\PY{n}{c⁻}\PY{p}{,} \PY{n}{c⁺}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
             \PY{k}{else}
                 \PY{n}{pcolor}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{zₗ}\PY{p}{)}
                 \PY{n}{clim}\PY{p}{(}\PY{n}{c⁻}\PY{p}{,} \PY{n}{c⁺}\PY{p}{)}
             \PY{k}{end}
             
             \PY{n}{set\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             
         \PY{k}{end}
         
         \PY{k}{for} \PY{n}{k} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{15}\PY{o}{:}\PY{n}{nₜ} \PY{c}{\PYZsh{} !! this looks better with a wider spread on the δ₌ function, e.g. Σ=0.1}
             \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{17}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
             \PY{n}{plot\PYZus{}u}\PY{p}{(}\PY{n}{𝑥}\PY{p}{,} \PY{n}{𝑦}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{𝐮ₜ}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{\PYZus{}contour}\PY{o}{=}\PY{o}{:}\PY{k+kc}{false}\PY{p}{,} \PY{n}{logarithm}\PY{o}{=}\PY{o}{:}\PY{k+kc}{false}\PY{p}{)}
             \PY{n}{k} \PY{o}{==} \PY{l+m+mi}{1} \PY{o}{?} \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{r}\PY{l+s}{u}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{p}\PY{l+s}{u}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{u}\PY{l+s}{(}\PY{l+s}{x}\PY{l+s}{,}\PY{l+s}{t}\PY{l+s}{)}\PY{l+s}{\PYZdq{}}\PY{p}{)} \PY{o}{:} \PY{n+nb}{nothing}
            
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
             \PY{n}{plot\PYZus{}u}\PY{p}{(}\PY{n}{𝑥}\PY{p}{,} \PY{n}{𝑦}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{𝐮ₚ}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{\PYZus{}contour}\PY{o}{=}\PY{o}{:}\PY{k+kc}{false}\PY{p}{,} \PY{n}{logarithm}\PY{o}{=}\PY{o}{:}\PY{k+kc}{false}\PY{p}{)}
             \PY{n}{k} \PY{o}{==} \PY{l+m+mi}{1} \PY{o}{?} \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{B}\PY{l+s}{a}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{s}\PY{l+s}{ }\PY{l+s}{f}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{a}\PY{l+s}{p}\PY{l+s}{p}\PY{l+s}{r}\PY{l+s}{o}\PY{l+s}{x}\PY{l+s}{i}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)} \PY{o}{:} \PY{n+nb}{nothing}
             
         \PY{k}{end}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{State Space Model
Representation}\label{state-space-model-representation}

\[
    \frac{\partial}{\partial t}\mathbf{f}(\mathbf{x}, t) = \mathscr{A}_f\mathbf{f}(\mathbf{x},t) +  \mathbf{C}_u\mathbf{u}(\mathbf{x},t)
\]

\[
    \frac{\partial}{\partial t}\mathbf{u}(\mathbf{x}, t) = \mathscr{A}_u\mathbf{u}(\mathbf{x},t) + \mathbf{B}_uw(t)
\]

\[
    \mathbf{y}_{t} = \mathbf{H}\mathbf{f}(\mathbf{x},t) + \nu_t
\]

\subsubsection{Process Model}\label{process-model}

\(\mathbf{F} = \mathrm{diag}\left[-D\lambda(\mathbf{n})\right]\)

\(\mathbf{L} = \mathbf{I}\)

\(\mathscr{U} = \exp\left(\Delta_t\begin{bmatrix}\mathbf{F} & \mathbf{L} \\ \mathbf{0} & \mathbf{0}\end{bmatrix}\right)\)

\(\mathscr{A} = \mathscr{U_{1:n;1:n}}, \qquad \mathscr{B}_{1:n;n+1:2n}\)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{ℱ} \PY{o}{=} \PY{p}{[} \PY{n}{diagm}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{D}\PY{o}{.*}\PY{n}{λₙ}\PY{p}{)} \PY{n}{eye}\PY{p}{(}\PY{n}{N}\PY{p}{)}\PY{p}{;} \PY{n}{zeros}\PY{p}{(}\PY{n}{N}\PY{p}{,} \PY{l+m+mi}{2}\PY{n}{N}\PY{p}{)}\PY{p}{]}
         
         \PY{n}{Δₜ} \PY{o}{=} \PY{n}{𝐭}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{𝐭}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{𝒰} \PY{o}{=} \PY{n}{expm}\PY{p}{(}\PY{n}{Δₜ} \PY{o}{*} \PY{n}{ℱ}\PY{p}{)}
         
         \PY{n}{𝒜}\PY{p}{,} \PY{n}{ℬ} \PY{o}{=} \PY{n}{𝒰}\PY{p}{[}\PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N}\PY{p}{,} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N}\PY{p}{]}\PY{p}{,} \PY{n}{𝒰}\PY{p}{[}\PY{l+m+mi}{1}\PY{o}{:}\PY{n}{N}\PY{p}{,} \PY{n}{N}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{:}\PY{k}{end}\PY{p}{]}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{matshow}\PY{p}{(}\PY{n}{𝒜}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_35_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} PyObject <matplotlib.image.AxesImage object at 0x7f69d7da66a0>
\end{Verbatim}
            
    \subsubsection{Solving the evolutionary
PDE}\label{solving-the-evolutionary-pde}

Solve the convection-diffusion equation in basis function space using
SSM and map back to \(\Omega\)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{𝒇ᵩ} \PY{o}{=} \PY{k+kt}{Array}\PY{p}{\PYZob{}}\PY{n}{typeof}\PY{p}{(}\PY{n}{𝐮ᵩ}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{(}\PY{n}{nₜ}\PY{p}{)}  \PY{c}{\PYZsh{} Solution in basis space over which the evolutionary model is performed}
         \PY{n}{𝒇ₚ} \PY{o}{=} \PY{k+kt}{Array}\PY{p}{\PYZob{}}\PY{n}{typeof}\PY{p}{(}\PY{n}{𝐮ₚ}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{(}\PY{n}{nₜ}\PY{p}{)} \PY{c}{\PYZsh{} Approximate solution mapped into regular representation}
         
         \PY{n}{𝑓ₜ} \PY{o}{=} \PY{n}{zeros}\PY{p}{(}\PY{n}{N}\PY{p}{)} \PY{c}{\PYZsh{} initial condition}
         \PY{k}{for} \PY{n}{k} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{nₜ}
             \PY{n}{𝑓ₜ} \PY{o}{=} \PY{n}{𝒜} \PY{o}{*} \PY{n}{𝑓ₜ} \PY{o}{+} \PY{n}{ℬ} \PY{o}{*} \PY{n}{𝐮ᵩ}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{c}{\PYZsh{} prediction}
             
             \PY{n}{𝒇ᵩ}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n}{𝑓ₜ}
             
             \PY{n}{𝒇ₚ}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n}{sum}\PY{p}{(}\PY{p}{[}\PY{n}{λ} \PY{o}{*} \PY{n}{ϕᵢ} \PY{k}{for} \PY{p}{(}\PY{n}{ϕᵢ}\PY{p}{,} \PY{n}{λ}\PY{p}{)} \PY{o}{∈} \PY{n}{zip}\PY{p}{(}\PY{n}{fₙ}\PY{p}{,} \PY{n}{𝑓ₜ}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{c⁺}\PY{p}{,} \PY{n}{c⁻} \PY{o}{=} \PY{n}{maximum}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{maximum}\PY{p}{,} \PY{n}{𝒇ₚ}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{minimum}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{minimum}\PY{p}{,} \PY{n}{𝒇ₚ}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{k} \PY{o}{∈} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{10}\PY{o}{:}\PY{n}{nₜ}
             \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=} \PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
             \PY{n}{contour}\PY{p}{(}\PY{n}{𝑥}\PY{p}{,} \PY{n}{𝑦}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{𝒇ₚ}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{,} \PY{n}{linspace}\PY{p}{(}\PY{n}{c⁻}\PY{p}{,} \PY{n}{c⁺}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
             \PY{n}{set\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
             \PY{n}{pcolor}\PY{p}{(}\PY{n}{𝑥}\PY{p}{,} \PY{n}{𝑦}\PY{p}{,} \PY{n}{reshape}\PY{p}{(}\PY{n}{𝒇ₚ}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{,} \PY{n}{nₓ}\PY{p}{,} \PY{n}{nₓ}\PY{p}{)}\PY{p}{)}
             \PY{n}{clim}\PY{p}{(}\PY{n}{c⁻}\PY{p}{,}\PY{n}{c⁺}\PY{p}{)}
             \PY{n}{set\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
